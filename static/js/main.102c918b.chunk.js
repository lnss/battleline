(this.webpackJsonpbattleline=this.webpackJsonpbattleline||[]).push([[0],{114:function(e,t,r){"use strict";r.r(t);for(var a=r(1),n=r.n(a),l=r(70),s=r.n(l),i=(r(77),r(38)),c=r(40),o=r(5),u=r(2),h=[],p=["r","o","y","g","b","p"],d=["1","2","3","4","5","6","7","8","9","T"],f=new Map([["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["T",10]]),g=new Map([[1,"1"],[2,"2"],[3,"3"],[4,"4"],[5,"5"],[6,"6"],[7,"7"],[8,"8"],[9,"9"],[10,"T"]]),y=new Map([["ALX",[10,9,8,7,6,5,4,3,2,1]],["DAR",[10,9,8,7,6,5,4,3,2,1]],["CAV",[8]],["321",[3,2,1]]]),v=new Map([["straightflush",5],["set",4],["flush",3],["straight",2],["sum",1],["incomplete",0]]),m=0;10!==m;m++)for(var _=0;6!==_;_++){var b=d[m]+p[_];h.push(b)}var k=["ALX","DAR","CAV","321","TRA","DES","RDP","SCT","FOG","MUD"],E={name:"battle-line",setup:function(){var e=h.slice(),t=k.slice(),r=h.slice(),a=new Array(9).fill(new Array(2).fill([])),n=new Array(2).fill([]),l=new Array(9).fill(null),s=new Array(9).fill(null);M(e),M(t);var i=[];i.push([]),i.push([]);for(var c=0;7!==c;c++)for(var o=0;2!==o;o++)i[o].push(e.pop());return{troop_deck:e,tactics_deck:t,player_hands:i,board_cards:a,discards:n,unseen_cards:r,seen_cards:[],flag_statuses:l,flag_tiebreakers:s,tactics_played:[0,0],leaders_played:[0,0],scout_state:[0,0]}},minPlayers:2,maxPlayers:2,moves:{playCard:function(e,t,r,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=e.player_hands[t.currentPlayer][r];if(t.numMoves>0&&e.scout_state[1]>0)return-1!==a?u.x:(R(l)?e.troop_deck.push(l):F(l)&&e.tactics_deck.push(l),e.player_hands[t.currentPlayer].splice(r,1),e.scout_state[1]=e.scout_state[1]-1,void(e.scout_state[1]<=1&&(e.scout_state[0]=0,e.scout_state[1]=0,t.events.endTurn())));if(t.numMoves>0)return u.x;if(-1!==a&&(R(l)||O(l)||I(l))){var s=N(e.board_cards[a])?4:3;if(U(e.board_cards[a][t.currentPlayer])===s)return u.x}if(-1!==a&&null!==e.flag_statuses[a])return u.x;if(F(l)){if("0"===t.currentPlayer&&e.tactics_played[0]>e.tactics_played[1])return u.x;if("1"===t.currentPlayer&&e.tactics_played[1]>e.tactics_played[0])return u.x}if(G(l)&&e.leaders_played[t.currentPlayer]>0)return u.x;if(I(l)){if(null===n)return u.x;if(null!==e.flag_statuses[n[0]])return u.x;var i=e.board_cards[n[0]][n[1]][n[2]];if("TRA"===l){if(n[1]===t.currentPlayer||F(i)||-1===a)return u.x}else if("DES"===l){if(n[1]===t.currentPlayer||!L(i)||-1!==a)return u.x}else if("RDP"===l&&(n[1]!==t.currentPlayer||!L(i)||a===n[0]))return u.x}else if(j(l)){if(-1!==a)return u.x;var c=Math.min(3,e.troop_deck.length+e.tactics_deck.length);e.scout_state=[c,0]}else if(-1===a)return u.x;if(I(l)){var o=e.board_cards[n[0]][n[1]][n[2]];e.board_cards[n[0]][n[1]].splice(n[2],1),-1!==a?e.board_cards[a][t.currentPlayer].push(o):e.discards[n[1]].push(o),e.discards[t.currentPlayer].push(l),e.flag_tiebreakers[n[0]]===n[1]&&(e.flag_tiebreakers[n[0]]=null)}else j(l)?e.discards[t.currentPlayer].push(l):(e.board_cards[a][t.currentPlayer].push(l),"MUD"===l&&(e.flag_tiebreakers[a]=null));if(-1!==a){var h=N(e.board_cards[a]),p=h?4:3;(d=x(a,t.currentPlayer,e.board_cards))[0].length===p&&null===e.flag_tiebreakers[a]&&(e.flag_tiebreakers[a]=t.currentPlayer)}if(null!==n){var d,f=N(e.board_cards[n[0]]),g=f?4:3;(d=x(n[0],t.currentPlayer,e.board_cards))[0].length===g&&null===e.flag_tiebreakers[n[0]]?e.flag_tiebreakers[n[0]]=t.currentPlayer:d[1].length===g&&null===e.flag_tiebreakers[n[0]]&&(e.flag_tiebreakers[n[0]]=V(t.currentPlayer))}e.seen_cards.push(l),F(l)&&e.tactics_played[t.currentPlayer]++,G(l)&&e.leaders_played[t.currentPlayer]++;var y=e.unseen_cards.indexOf(l);-1!==y&&e.unseen_cards.splice(y,1),e.player_hands[t.currentPlayer].splice(r,1)},claimFlag:{move:function(e,t,r){if(null!==e.flag_statuses[r])return u.x;var a=function(e){for(var t=0;2!==t;t++)for(var r=0;r!==e[t].length;r++)if("FOG"===e[t][r])return!0;return!1}(e.board_cards[r]),n=N(e.board_cards[r]),l=x(r,t.currentPlayer,e.board_cards);if(!function(e,t,r,a,n,l){var s=function(e,t,r){var a=r?4:3;if(e.length!==a)return["incomplete",0];var n=w(e);if(t)return["sum",n];var l=T(e),s=C(e,r),i=P(e);return-1!==l&&-1!==s?["straightflush",s]:-1!==i?["set",i]:-1!==l?["flush",l]:-1!==s?["straight",s]:["sum",n]}(e,a,n),i=function(e,t,r,a){var n=-1;if(!r){if(-1!==(n=function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===n&&(n=r.length);var l=T(t),s=C(t,a);if(-1===l||-1===s)return-1;var i=a?4:3;if(t.length===i)return s;for(var c=n-1;c>=0;c--){var o=t.slice(),u=r.slice();o.push(r[c]),u.splice(c,1);var h=e(o,u,a,c);if(-1!==h)return h}return-1}(e,t,a)))return["straightflush",n];if(-1!==(n=function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===n&&(n=r.length);var l=P(t);if(-1===l)return-1;var s=a?4:3;if(t.length===s)return l;for(var i=n-1;i>=0;i--){var c=t.slice(),o=r.slice();c.push(r[i]),o.splice(i,1);var u=e(c,o,a,i);if(-1!==u)return u}return-1}(e,t,a)))return["set",n];if(-1!==(n=function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===n&&(n=r.length);var l=T(t);if(-1===l)return-1;var s=a?4:3;if(t.length===s)return l;for(var i=n-1;i>=0;i--){var c=t.slice(),o=r.slice();c.push(r[i]),o.splice(i,1);var u=e(c,o,a,i);if(-1!==u)return u}return-1}(e,t,a)))return["flush",n];if(-1!==(n=function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===n&&(n=r.length);var l=C(t,a);if(-1===l)return-1;var s=a?4:3;if(t.length===s)return l;for(var i=n-1;i>=0;i--){var c=t.slice(),o=r.slice();c.push(r[i]),o.splice(i,1);var u=e(c,o,a,i);if(-1!==u)return u}return-1}(e,t,a)))return["straight",n]}if(-1!==(n=function e(t,r,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===n&&(n=r.length);var l=w(t),s=a?4:3;if(t.length===s)return l;for(var i=n-1;i>=0;i--){var c=t.slice(),o=r.slice();c.push(r[i]),o.splice(i,1);var u=e(c,o,a,i);if(-1!==u)return u}return-1}(e,t,a)))return["sum",n];return["incomplete",n]}(t,r,a,n);return function(e,t,r){return v.get(e[0])>v.get(t[0])||!(v.get(e[0])<v.get(t[0]))&&(e[1]>t[1]||!(e[1]<t[1])&&r)}(s,i,l)}(l[0],l[1],e.unseen_cards,a,n,e.flag_tiebreakers[r]===t.currentPlayer))return u.x;e.flag_statuses[r]=t.currentPlayer},noLimit:!0},drawCard:{move:function(e,t,r){if(0===t.numMoves)return u.x;if((0!=e.scout_state[0]||0!=e.scout_state[1])&&e.scout_state[0]<=e.scout_state[1])return u.x;if("troop"===r&&0===e.troop_deck.length)return u.x;if("tactics"===r&&0===e.tactics_deck.length)return u.x;if("troop"===r)e.player_hands[t.currentPlayer].push(e.troop_deck.pop());else{if("tactics"!==r)return u.x;e.player_hands[t.currentPlayer].push(e.tactics_deck.pop())}if(0!=e.scout_state[0]||0!=e.scout_state[1])return e.scout_state[1]=e.scout_state[1]+1,void(e.scout_state[0]===e.scout_state[1]&&(e.scout_state[0]=0));t.events.endTurn()},client:!1},passTurn:function(e,t){if(!S(e,t))return u.x;t.events.endTurn()}},playerView:function(e,t,r){return function(e,t){for(var r=new Array(e.troop_deck.length).fill("troop"),a=new Array(e.tactics_deck.length).fill("tactics"),n=[],l=0;2!==l;l++)if(parseInt(t)===l)n.push(e.player_hands[l]);else{for(var s=[],i=0;i!==e.player_hands[l].length;i++)R(e.player_hands[l][i])||"troop"===e.player_hands[l][i]?s.push("troop"):s.push("tactics");n.push(s)}return{troop_deck:r,tactics_deck:a,player_hands:n,board_cards:e.board_cards,discards:e.discards,unseen_cards:e.unseen_cards,seen_cards:e.seen_cards,flag_statuses:e.flag_statuses,flag_tiebreakers:e.flag_tiebreakers,tactics_played:e.tactics_played,leaders_played:e.leaders_played,scout_state:e.scout_state}}(e,r)},endIf:function(e,t){if(function(e,t){for(var r=0,a=0,n=0;9!==n;n++)if(e[n]===t?(r++,a++):a=0,r>=5||a>=3)return!0;return!1}(e.flag_statuses,t.currentPlayer))return{winner:t.currentPlayer}}};function x(e,t,r){for(var a=[],n=[],l=0;2!==l;l++)for(var s=0;s!==r[e][l].length;s++)l===parseInt(t)?L(r[e][l][s])&&a.push(r[e][l][s]):L(r[e][l][s])&&n.push(r[e][l][s]);return[a,n]}function T(e){for(var t=null,r=0,a=0;a!==e.length;a++)if(R(e[a])){if(r+=f.get(e[a][0]),null===t)t=e[a][1];else if(t!==e[a][1])return-1}else r+=y.get(e[a])[0];return r}function C(e,t){for(var r=0;r!==e.length;r++)if(!R(e[r])){for(var a=y.get(e[r]),n=e[r],l=-1,s=0;s!==a.length;s++){e[r]=g.get(a[s])+"x";var i=C(e,t);i>l&&(l=i)}return e[r]=n,l}return function(e,t){for(var r=0,a=0;a!==e.length;a++){f.get(e[a][0])>r&&(r=f.get(e[a][0]));for(var n=a+1;n!==e.length;n++){var l=Math.abs(f.get(e[a][0])-f.get(e[n][0])),s=t?3:2;if(0===l||l>s)return-1}}return e.length*(2*r-e.length+1)/2}(e,t)}function P(e){for(var t=new Set([1,2,3,4,5,6,7,8,9,10]),r=0;r!==e.length;r++)if(0===(t=R(e[r])?A(t,new Set([f.get(e[r][0])])):A(t,new Set(y.get(e[r])))).size)return-1;return t.values().next().value*e.length}function A(e,t){return new Set(Object(o.a)(e).filter((function(e){return t.has(e)})))}function w(e){for(var t=0,r=0;r!==e.length;r++)2===e[r].length?t+=f.get(e[r][0]):t+=y.get(e[r])[0];return t}function M(e){for(var t=e.length-1;t>=0;t--){var r=Math.floor(Math.random()*(t+1)),a=e[r];e[r]=e[t],e[t]=a}return e}function S(e,t){return 0===t.numMoves?!function(e,t,r,a){for(var n=!1,l=0;l!==a.length&&!n;l++)R(a[l])&&(n=!0);if(!n)return!1;for(var s=0;9!==s;s++){var i=N(e[s])?4:3;if(U(e[s][t])!==i&&null===r[s])return!0}return!1}(e.board_cards,t.currentPlayer,e.flag_statuses,e.player_hands[t.currentPlayer]):0===e.troop_deck.length&&0===e.tactics_deck.length}function D(e,t,r,a,n,l){return!!L(a)&&(null===e.flag_statuses[l]&&(("TRA"!==r||n!==t.currentPlayer&&!F(a))&&(("DES"!==r||n!==t.currentPlayer)&&("RDP"!==r||n===t.currentPlayer))))}function R(e){return 2===e.length}function F(e){return 3===e.length}function O(e){return["ALX","DAR","CAV","321"].indexOf(e)>=0}function G(e){return["ALX","DAR"].indexOf(e)>=0}function I(e){return["TRA","DES","RDP"].indexOf(e)>=0}function j(e){return["SCT"].indexOf(e)>=0}function L(e){return R(e)||O(e)}function U(e){for(var t=0,r=0;r!==e.length;r++)L(e[r])&&t++;return t}function N(e){for(var t=0;2!==t;t++)for(var r=0;r!==e[t].length;r++)if("MUD"===e[t][r])return!0;return!1}function V(e){return"0"===e?"1":"0"}var W=r(4),B=r(6),J=r(8),X=r(9),Y=new Map([["r","#FF0000"],["o","#FFA500"],["y","#FFFF00"],["g","#008000"],["b","#0000FF"],["p","#800080"]]),z=new Map([["ALX",[["ALEXANDER"],6]],["DAR",[["DARIUS"],9]],["CAV",[["COMPANION","CAVALRY"],6]],["321",[["SHIELD","BEARERS"],8]],["TRA",[["TRAITOR"],9]],["DES",[["DESERTER"],7]],["RDP",[["REDEPLOY"],7]],["SCT",[["SCOUT"],9]],["FOG",[["FOG"],9]],["MUD",[["MUD"],9]]]),q=function(e){Object(J.a)(r,e);var t=Object(X.a)(r);function r(e){var a;return Object(W.a)(this,r),(a=t.call(this,e)).cardRefs=n.a.createRef(),a.height="deck"===a.props.side?120:150,a}return Object(B.a)(r,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.cardRefs.current.getContext("2d");e.clearRect(0,0,80,this.height);var t="top"===this.props.side&&this.props.selected||"bottom"===this.props.side&&!this.props.selected||"deck"===this.props.side?0:30;e.translate(0,t),2===this.props.str.length?K(e,this.props.str,null):3===this.props.str.length?Q(e,this.props.str,null):"troop"===this.props.str?function(e){Z(e,80,120,7,"#000000"),e.fillStyle="#D2B48C",e.fillRect(7,7,66,106),e.font="14px Verdana",e.fillStyle="#000000",e.textAlign="center",e.fillText("TROOP",40,60)}(e):"tactics"===this.props.str&&function(e){Z(e,80,120,7,"#855040"),e.fillStyle="#D2B48C",e.fillRect(7,7,66,106),e.font="14px Verdana",e.fillStyle="#000000",e.textAlign="center",e.fillText("TACTICS",40,60)}(e),e.translate(0,-t)}},{key:"render",value:function(){return n.a.createElement("canvas",{ref:this.cardRefs,width:80,height:this.height})}}]),r}(n.a.Component),H=function(e){Object(J.a)(r,e);var t=Object(X.a)(r);function r(e){var a;return Object(W.a)(this,r),(a=t.call(this,e)).formationRefs=n.a.createRef(),a}return Object(B.a)(r,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.formationRefs.current.getContext("2d");if(e.clearRect(0,0,80,295),"top"===this.props.side){e.translate(0,175);for(var t=0;t!==this.props.cards.length;t++)2===this.props.cards[t].length?K(e,this.props.cards[t],this.props.highlights[t]):3===this.props.cards[t].length&&Q(e,this.props.cards[t],this.props.highlights[t]),e.translate(0,-35);e.translate(0,-35*(5-this.props.cards.length))}else{for(var r=0;r!==this.props.cards.length;r++)2===this.props.cards[r].length?K(e,this.props.cards[r],this.props.highlights[r]):3===this.props.cards[r].length&&Q(e,this.props.cards[r],this.props.highlights[r]),e.translate(0,35);e.translate(0,-35*this.props.cards.length)}this.props.show_flag&&ee(e,"top"===this.props.side?35*(7-this.props.cards.length):35*this.props.cards.length)}},{key:"render",value:function(){return n.a.createElement("canvas",{ref:this.formationRefs,width:80,height:295})}}]),r}(n.a.Component),$=function(e){Object(J.a)(r,e);var t=Object(X.a)(r);function r(e){var a;return Object(W.a)(this,r),(a=t.call(this,e)).flagRefs=n.a.createRef(),a}return Object(B.a)(r,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.flagRefs.current.getContext("2d");e.clearRect(0,0,80,50),this.props.show_flag&&ee(e,0)}},{key:"render",value:function(){return n.a.createElement("canvas",{ref:this.flagRefs,width:80,height:50})}}]),r}(n.a.Component);function K(e,t,r){var a=t[0],n=t[1];null===r&&(r="#FFFFFF"),Z(e,80,120,7,r),e.fillStyle=Y.get(n),e.fillRect(7,7,66,106),e.fillStyle="#FFFFFF",e.fillRect(7,7,20,25),e.fillRect(53,88,20,25),e.font="18px Verdana",e.fillStyle="#000000",e.textAlign="center";for(var l=e.measureText("M").width,s=0;2!==s;s++){if("T"!==a)e.fillText(a,17,19.5+l/2-2);else{var i=e.measureText("1").width,c=e.measureText("0").width;e.fillText("1",17-i/2+2,19.5+l/2-2),e.fillText("0",17+c/2-2,19.5+l/2-2)}if("6"===a||"9"===a){var o=e.measureText(a).width;e.lineWidth=1,e.beginPath(),e.moveTo(17-o/2,19.5+l/2+1),e.lineTo(17+o/2,19.5+l/2+1),e.stroke()}e.rotate(Math.PI),e.translate(-80,-120)}}function Q(e,t,r){null===r&&(r="#FFFFFF"),Z(e,80,120,7,r),e.fillStyle="#E4DB86",e.fillRect(7,7,66,106),e.fillStyle="#FFFFFF",e.fillRect(7,7,20,25),e.fillRect(53,88,20,25);var a=z.get(t),n=a[0],l=a[1];te(t,e,40,60,40,40);for(var s=0;2!==s;s++){e.font=l.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";for(var i=e.measureText("M").width,c=0;c!==n.length;c++)e.fillText(n[c],50,(42+i*n.length)/2-i*(n.length-1-c));te(t,e,17,17.5,18,18),e.rotate(Math.PI),e.translate(-80,-120)}3===a.length&&(console.log(a[2]),a[2]())}function Z(e,t,r,a,n){e.strokeStyle="#000000",e.fillStyle=n;e.lineWidth=2,e.beginPath(),e.moveTo(a+1,1),e.lineTo(t-a-1,1),e.arcTo(t-1,1,t-1,a+1,a+1),e.lineTo(t-1,r-a-1),e.arcTo(t-1,r-1,t-a-1,r-1,a+1),e.lineTo(a+1,r-1),e.arcTo(1,r-1,1,a+1,a+1),e.lineTo(1,a+1),e.arcTo(1,1,a+1,1,a+1),e.closePath(),e.fill(),e.stroke()}function ee(e,t){var r=document.getElementById("flag");e.drawImage(r,15,t,50,50)}function te(e,t,r,a,n,l){"ALX"===e||"DAR"===e?function(e,t,r,a,n){e.strokeStyle="#000000",e.fillStyle="#000000";e.lineWidth=1;var l=[t-(a=.9*a-4)/3,r+(n*=.9)/2],s=[t+a/3,r+n/2],i=[t-a/2,r-n/2+2],c=[t,r-n/2+2],o=[t+a/2,r-n/2+2],u=[t-a/6,r],h=[t+a/6,r];e.beginPath(),e.moveTo(l[0],l[1]),e.lineTo(i[0],i[1]),e.lineTo(u[0],u[1]),e.lineTo(c[0],c[1]),e.lineTo(h[0],h[1]),e.lineTo(o[0],o[1]),e.lineTo(s[0],s[1]),e.lineTo(l[0],l[1]),e.closePath(),e.fill(),e.stroke()}(t,r,a,n,l):"CAV"===e?function(e,t,r,a){e.font=a.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";var n=e.measureText("M").width,l=a<30?0:7;e.fillText("8",t,r+n/2-l)}(t,r,a,l):"321"===e?function(e,t,r,a,n){e.font=(n/2).toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";var l=e.measureText("M").width,s=n<30?0:7;e.fillText("321",t,r+l/2-s)}(t,r,a,0,l):"TRA"===e?function(e,t,r,a,n){e.strokeStyle="#000000",e.fillStyle="#000000";e.lineWidth=1;var l=[t-.2*(a=.4*a-4),r-(n*=.9)/2+2],s=[t+.2*a,r-n/2+2],i=[t+.2*a,r+n/2-a],c=[t+a,r+n/2-a],o=[t,r+n/2],u=[t-a,r+n/2-a],h=[t-.2*a,r+n/2-a];e.beginPath(),e.moveTo(l[0],l[1]),e.lineTo(s[0],s[1]),e.lineTo(i[0],i[1]),e.lineTo(c[0],c[1]),e.lineTo(o[0],o[1]),e.lineTo(u[0],u[1]),e.lineTo(h[0],h[1]),e.fill(),e.stroke()}(t,r,a,n,l):"DES"===e?function(e,t,r,a,n){e.strokeStyle="#000000",a=.7*a-4;var l=(n*=.9)/5;e.lineWidth=l;var s=[t-a/2,r-n/2+2],i=[t+a/2,r-n/2+2],c=[t-a/2,r+n/2],o=[t+a/2,r+n/2];e.beginPath(),e.moveTo(s[0],s[1]),e.lineTo(o[0],o[1]),e.moveTo(i[0],i[1]),e.lineTo(c[0],c[1]),e.stroke()}(t,r,a,n,l):"RDP"===e?function(e,t,r,a,n){e.strokeStyle="#000000",e.fillStyle="#000000";e.lineWidth=1;var l=[t-(a=.9*a-4)/2,r-.2*(n=.4*n-4)],s=[t-a/2,r+.2*n],i=[t+a/2-n,r+.2*n],c=[t+a/2-n,r+n],o=[t+a/2,r],u=[t+a/2-n,r-n],h=[t+a/2-n,r-.2*n];e.beginPath(),e.moveTo(l[0],l[1]),e.lineTo(s[0],s[1]),e.lineTo(i[0],i[1]),e.lineTo(c[0],c[1]),e.lineTo(o[0],o[1]),e.lineTo(u[0],u[1]),e.lineTo(h[0],h[1]),e.fill(),e.stroke()}(t,r,a,n,l):"SCT"===e?function(e,t,r,a,n){e.strokeStyle="#000000",e.fillStyle="#000000",n=.5*(a=.9*a-4);e.lineWidth=1;var l=(Math.pow(n/2,2)-Math.pow(a/2,2))/n,s=Math.sqrt(Math.pow(a/2,2)+Math.pow(l,2)),i=Math.atan(2*l/a);e.beginPath(),e.moveTo(t+a/2,r),e.arc(t,r-l,s,i,Math.PI-i,!0),e.arc(t,r+l,s,Math.PI+i,-i,!0),e.stroke(),e.beginPath(),e.moveTo(t+.2*n,r),e.arc(t,r,.2*n,0,2*Math.PI,!1),e.stroke(),e.fill(),e.beginPath(),e.moveTo(t+.5*n,r),e.arc(t,r,.5*n,0,2*Math.PI,!1),e.stroke()}(t,r,a,n,l):"MUD"===e?function(e,t,r,a){e.font=a.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";var n=e.measureText("M").width,l=a<30?0:7;e.fillText("+",t,r+n/2-l)}(t,r,a,l):"FOG"===e&&function(e,t,r,a){e.font=a.toString()+"px Verdana",e.fillStyle="#000000",e.textAlign="center";var n=e.measureText("M").width,l=a<30?0:7;e.fillText("#",t,r+n/2-l)}(t,r,a,l)}var re=function(e){Object(J.a)(r,e);var t=Object(X.a)(r);function r(e){var a;return Object(W.a)(this,r),(a=t.call(this,e)).selected_card=null,a.displaced_card=null,a}return Object(B.a)(r,[{key:"onClickCard",value:function(e,t){this.props.ctx.currentPlayer===e&&this.props.ctx.currentPlayer===this.props.playerID&&(this.selected_card!==t?(this.selected_card=t,this.displaced_card=null,this.forceUpdate()):(this.selected_card=null,this.displaced_card=null,this.forceUpdate()))}},{key:"onClickSlot",value:function(e,t,r){if(null!==this.selected_card){var a=this.props.G.player_hands[this.props.ctx.currentPlayer][this.selected_card];if(I(a)&&-1!==t)for(var n=r.target.getBoundingClientRect(),l="0"===e?n.bottom-r.clientY:r.clientY-n.top,s=this.props.G.board_cards[t][e].length,i=0,c=0;c!==s;c++){if(l<(i+=c!==s-1?35:120)){var o=this.props.G.board_cards[t][e][c];if(D(this.props.G,this.props.ctx,a,o,e,t)){var u=[t,e,c];if(null===this.displaced_card)return this.displaced_card=u,void this.forceUpdate();if(ae(this.displaced_card,u))return this.displaced_card=null,void this.forceUpdate();break}break}}if(I(a)){if(this.props.ctx.currentPlayer!==e&&"DES"!==a)return;if(null===this.displaced_card)return;this.props.moves.playCard(this.selected_card,t,this.displaced_card),this.selected_card=null,this.displaced_card=null,this.forceUpdate()}else if(j(a)){if(-1!==t)return;this.props.moves.playCard(this.selected_card,t),this.selected_card=null,this.displaced_card=null,this.forceUpdate()}else{if(this.props.ctx.currentPlayer!==e)return;if(-1===t)return;this.props.moves.playCard(this.selected_card,t),this.selected_card=null,this.displaced_card=null,this.forceUpdate()}}}},{key:"onClickFlag",value:function(e){this.props.moves.claimFlag(e)}},{key:"onClickDeck",value:function(e){if(null!==this.selected_card){var t=this.props.G.player_hands[this.props.ctx.currentPlayer][this.selected_card];(j(t)||R(t)&&"troop"==e||F(t)&&"tactics"==e)&&(this.props.moves.playCard(this.selected_card,-1),this.selected_card=null,this.displaced_card=null,this.forceUpdate())}this.props.moves.drawCard(e)}},{key:"onClickPass",value:function(){this.props.moves.passTurn()}},{key:"render",value:function(){var e=this,t=[],r=[],a="";void 0!==this.props.ctx.gameover&&"0"===this.props.ctx.gameover.winner?a="Winner!":"0"===this.props.ctx.currentPlayer&&(a="Your turn!"),r.push(n.a.createElement("td",{key:r.length,style:{textAlign:"center"}},a));for(var l=function(t){r.push(n.a.createElement("td",{key:r.length,onClick:function(){return e.onClickCard("0",t)}},n.a.createElement(q,{str:e.props.G.player_hands[0][t],side:"top",selected:t===e.selected_card&&"0"===e.props.ctx.currentPlayer&&"0"===e.props.playerID&&0===e.props.ctx.numMoves})))},s=0;s<this.props.G.player_hands[0].length;s++)l(s);for(var i=0;i!==9-this.props.G.player_hands[0].length;i++)r.push(n.a.createElement("td",{key:r.length}));var c=[new Array(this.props.G.discards[0].length).fill(null),new Array(this.props.G.discards[1].length).fill(null)];this.props.G.discards[0].length>0&&this.props.G.discards[0].slice(-1)[0]===this.props.G.seen_cards.slice(-1)[0]&&"0"!==this.props.playerID&&(c[0][this.props.G.discards[0].length-1]="#000000"),this.props.G.discards[1].length>0&&this.props.G.discards[1].slice(-1)[0]===this.props.G.seen_cards.slice(-1)[0]&&"1"!==this.props.playerID&&(c[1][this.props.G.discards[1].length-1]="#000000"),r.push(n.a.createElement("td",{rowSpan:"5",key:r.length},n.a.createElement("table",{id:"tactics_deck",style:{margin:"auto"}},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",{onClick:function(t){return e.onClickSlot("0",-1,t)}},n.a.createElement(H,{cards:this.props.G.discards[0],side:"top",show_flag:!1,highlights:c[0]}))),n.a.createElement("tr",null,n.a.createElement("td",{onClick:function(){return e.onClickDeck("tactics")}},n.a.createElement(q,{str:this.props.G.tactics_deck.length>0?this.props.G.tactics_deck[0]:"",side:"deck"}))),n.a.createElement("tr",null,n.a.createElement("td",{onClick:function(t){return e.onClickSlot("1",-1,t)}},n.a.createElement(H,{cards:this.props.G.discards[1],side:"bottom",show_flag:!1,highlights:c[1]}))))))),t.push(n.a.createElement("tr",{key:t.length},r)),r=[];for(var o=new Array(2).fill("none"),u=0;2!==u;u++)this.props.ctx.currentPlayer===this.props.playerID&&this.props.ctx.currentPlayer===u.toString()&&S(this.props.G,this.props.ctx)&&(o[u]="block");r.push(n.a.createElement("td",{rowSpan:"3",key:r.length},n.a.createElement("table",{id:"troop_deck",style:{margin:"auto"}},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",{style:{height:"50px"}},n.a.createElement("input",{type:"button",value:"Pass",style:{margin:"auto",display:o[0]},onClick:function(){return e.onClickPass()}}))),n.a.createElement("tr",null,n.a.createElement("td",{style:{height:"120px"},onClick:function(){return e.onClickDeck("troop")}},n.a.createElement(q,{str:this.props.G.troop_deck.length>0?this.props.G.troop_deck[0]:"",side:"deck"}))),n.a.createElement("tr",null,n.a.createElement("td",{style:{height:"50px"}},n.a.createElement("input",{type:"button",value:"Pass",style:{margin:"auto",display:o[1]},onClick:function(){return e.onClickPass()}})))))));for(var h=function(t){var a=e.props.G.board_cards[t][0],l="0"===e.props.G.flag_statuses[t],s=new Array(a.length).fill(null);a.length>0&&a.slice(-1)[0]===e.props.G.seen_cards.slice(-1)[0]&&"0"!==e.props.playerID&&(s[a.length-1]="#000000"),null!==e.displaced_card&&e.displaced_card[0]===t&&"0"===e.displaced_card[1]&&(s[e.displaced_card[2]]="#AAAAAA"),r.push(n.a.createElement("td",{key:r.length,onClick:function(r){return e.onClickSlot("0",t,r)}},n.a.createElement(H,{cards:a,side:"top",show_flag:l,highlights:s})))},p=0;p<9;p++)h(p);t.push(n.a.createElement("tr",{key:t.length},r)),r=[];for(var d=function(t){r.push(n.a.createElement("td",{key:r.length,onClick:function(){return e.onClickFlag(t)}},n.a.createElement($,{show_flag:null===e.props.G.flag_statuses[t]})))},f=0;f<9;f++)d(f);t.push(n.a.createElement("tr",{key:t.length},r)),r=[];for(var g=function(t){var a=e.props.G.board_cards[t][1],l="1"===e.props.G.flag_statuses[t],s=new Array(a.length).fill(null);a.length>0&&a.slice(-1)[0]===e.props.G.seen_cards.slice(-1)[0]&&"1"!==e.props.playerID&&(s[a.length-1]="#000000"),null!==e.displaced_card&&e.displaced_card[0]===t&&"1"===e.displaced_card[1]&&(s[e.displaced_card[2]]="#AAAAAA"),r.push(n.a.createElement("td",{key:r.length,onClick:function(r){return e.onClickSlot("1",t,r)}},n.a.createElement(H,{cards:a,side:"bottom",show_flag:l,highlights:s})))},y=0;y<9;y++)g(y);t.push(n.a.createElement("tr",{key:t.length},r)),r=[],a="",void 0!==this.props.ctx.gameover&&"1"===this.props.ctx.gameover.winner?a="Winner!":"1"===this.props.ctx.currentPlayer&&(a="Your turn!"),r.push(n.a.createElement("td",{key:r.length,style:{textAlign:"center"}},a));for(var v=function(t){r.push(n.a.createElement("td",{key:r.length,onClick:function(){return e.onClickCard("1",t)}},n.a.createElement(q,{str:e.props.G.player_hands[1][t],side:"bottom",selected:t===e.selected_card&&"1"===e.props.ctx.currentPlayer&&"1"===e.props.playerID&&0===e.props.ctx.numMoves})))},m=0;m<this.props.G.player_hands[1].length;m++)v(m);return t.push(n.a.createElement("tr",{key:t.length},r)),n.a.createElement("div",null,n.a.createElement("table",{id:"board",style:{margin:"auto"}},n.a.createElement("tbody",null,t)))}}]),r}(n.a.Component);function ae(e,t){if(null===e&&null===t)return!0;if(null===e||null===t)return!1;if(e.length!==t.length)return!1;for(var r=0;r!==e.length;r++)if(e[r]!==t[r])return!1;return!0}var ne=function(e){Object(J.a)(r,e);var t=Object(X.a)(r);function r(){return Object(W.a)(this,r),t.apply(this,arguments)}return Object(B.a)(r,[{key:"handleChangeName",value:function(e){this.setState({playerName:e.target.value})}},{key:"handleNewMatch",value:function(e){console.log("New match"),this._createMatch("battle-line",2)}},{key:"handleRefreshMatches",value:function(e){console.log("Refresh matches"),this._updateConnection()}},{key:"handleJoinMatch",value:function(e,t,r){console.log("Join match"),console.log(t),console.log(r),this._joinMatch("battle-line",t,r)}},{key:"handleLeaveMatch",value:function(e,t){console.log("Leave match"),this._leaveMatch("battle-line",t)}},{key:"handleEnterLobby",value:function(e){console.log("Enter lobby"),this._enterLobby(this.state.playerName)}},{key:"handleExitLobby",value:function(e){console.log("Exit lobby"),this._exitLobby()}},{key:"handleStartMatch",value:function(e,t,r){console.log("Start match"),this._startMatch("battle-line",{numPlayers:2,matchID:t,playerID:r})}},{key:"handleExitMatch",value:function(e){console.log("Exit match"),this._exitMatch()}},{key:"render",value:function(){var e=this,t=[],r=[],a={width:"150px",textAlign:"center",padding:"3px"},l={width:"150px",textAlign:"center",padding:"3px"},s={width:"30px",textAlign:"center",padding:"3px"},i={width:"100px",textAlign:"center",padding:"3px"};r.push(n.a.createElement("th",{style:a},"Match ID")),r.push(n.a.createElement("th",{style:l},"Player 1")),r.push(n.a.createElement("th",{style:s},"vs.")),r.push(n.a.createElement("th",{style:l},"Player 2")),r.push(n.a.createElement("th",{style:i},n.a.createElement("input",{type:"button",value:"New Match",onClick:function(t){return e.handleNewMatch(t)}}))),r.push(n.a.createElement("th",{style:i},n.a.createElement("input",{type:"button",value:"Refresh",onClick:function(t){return e.handleRefreshMatches(t)}}))),t.push(n.a.createElement("tr",null,r));var c=[];console.log("Loop through matches");for(var o=function(){h=[];var t=e.connection.matches[u];if(console.log(t),p=t.players.length>0?t.players[0].name:void 0,d=t.players.length>1?t.players[1].name:void 0,console.log(p),console.log(d),h.push(n.a.createElement("td",{style:a},t.matchID)),void 0!==p?h.push(n.a.createElement("td",{style:l},p)):h.push(n.a.createElement("td",{style:l},n.a.createElement("input",{type:"button",value:"Join",onClick:function(r){return e.handleJoinMatch(r,t.matchID,0)}}))),h.push(n.a.createElement("td",{style:s},"vs.")),void 0!==d?h.push(n.a.createElement("td",{style:l},d)):h.push(n.a.createElement("td",{style:l},n.a.createElement("input",{type:"button",value:"Join",onClick:function(r){return e.handleJoinMatch(r,t.matchID,1)}}))),p===e.state.playerName||d===e.state.playerName?h.push(n.a.createElement("td",{style:i},n.a.createElement("input",{type:"button",value:"Leave",onClick:function(r){return e.handleLeaveMatch(r,t.matchID)}}))):h.push(n.a.createElement("td",{style:i})),p===e.state.playerName&&void 0!==d||d===e.state.playerName&&void 0!==p){var r=e.state.playerName===p?"0":"1";h.push(n.a.createElement("td",{style:i},n.a.createElement("input",{type:"button",value:"Play",onClick:function(a){return e.handleStartMatch(a,t.matchID,r)}})))}else h.push(n.a.createElement("td",{style:i}));c.push(n.a.createElement("tr",null,h))},u=0;u!==this.connection.matches.length;u++){var h,p,d;o()}if("enter"===this.state.phase)return n.a.createElement("div",null,"Enter name: ",n.a.createElement("input",{type:"text",value:this.state.playerName,onChange:function(t){return e.handleChangeName(t)}}),n.a.createElement("input",{type:"button",value:"Enter Lobby",onClick:function(t){return e.handleEnterLobby(t)}}));if("list"===this.state.phase)return n.a.createElement("div",null,n.a.createElement("input",{type:"button",value:"Exit Lobby",onClick:function(t){return e.handleExitLobby(t)}}),n.a.createElement("br",null),n.a.createElement("table",{id:"matches"},n.a.createElement("thead",null,t),n.a.createElement("tbody",null,c)));if("play"===this.state.phase){var f=n.a.createElement(this.state.runningMatch.app,{matchID:this.state.runningMatch.matchID,playerID:this.state.runningMatch.playerID,credentials:this.state.runningMatch.credentials});return n.a.createElement("div",null,f)}}}]),r}(i.b),le=function(e){Object(J.a)(r,e);var t=Object(X.a)(r);function r(){return Object(W.a)(this,r),t.apply(this,arguments)}return Object(B.a)(r,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("table",{style:{width:"100%"},bgcolor:"#E4DB86"},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",{style:{fontFamily:"Verdana",fontSize:"30px",padding:"10px"}},n.a.createElement("a",{href:"https://rsandzimier.github.io/battleline/",style:{color:"inherit",textDecoration:"none"}},"BATTLE LINE")),n.a.createElement("td",{style:{textAlign:"right"}},n.a.createElement("a",{href:"https://github.com/rsandzimier/battleline"},n.a.createElement("img",{id:"github",src:"https://raw.githubusercontent.com/rsandzimier/battleline/master/github_logo.png",style:{height:"50px"},alt:"Github logo"})))))),n.a.createElement("br",null))}}]),r}(n.a.Component),se=(Object(i.a)({game:E,board:re,multiplayer:Object(c.b)({server:"https://battleline-backend.herokuapp.com"})}),function(){return n.a.createElement("div",null,n.a.createElement(le,null),n.a.createElement(ne,{gameServer:"https://battleline-backend.herokuapp.com",lobbyServer:"https://battleline-backend.herokuapp.com",gameComponents:[{game:E,board:re}]}))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},72:function(e,t,r){e.exports=r(114)},77:function(e,t,r){}},[[72,1,2]]]);
//# sourceMappingURL=main.102c918b.chunk.js.map