(this.webpackJsonpbattleline=this.webpackJsonpbattleline||[]).push([[0],{57:function(e,t,n){e.exports=n(99)},62:function(e,t,n){},95:function(e,t){},99:function(e,t,n){"use strict";n.r(t);for(var r=n(1),a=n.n(r),l=n(54),s=n.n(l),o=(n(62),n(26)),i=n(27),u=n(0),c=[],p=["r","o","y","g","b","p"],h=["1","2","3","4","5","6","7","8","9","T"],f=new Map([["1",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["T",10]]),d=new Map([["straightflush",5],["set",4],["flush",3],["straight",2],["sum",1],["incomplete",0]]),m=0;10!==m;m++)for(var v=0;6!==v;v++){var y=h[m]+p[v];c.push(y)}var g=c.slice();F(g);var b=["ALX","DAR","CAV","321","TRA","DES","RDP","SCT","FOG","MUD"].slice();F(b);var E=[];E.push([]),E.push([]);for(var k=0;7!==k;k++)for(var _=0;2!==_;_++)E[_].push(g.pop());var C=new Array(9).fill(new Array(2).fill([])),x=c.slice(),w=new Array(9).fill(null),R={name:"battle-line",setup:function(){return{troop_deck:g,tactics_deck:b,player_hands:E,board_cards:C,unseen_cards:x,flag_statuses:w}},minPlayers:2,maxPlayers:2,moves:{playCard:function(e,t,n,r){if(t.numMoves>0)return u.y;if(3===e.board_cards[r][t.currentPlayer].length)return u.y;if(null!==e.flag_statuses[r])return u.y;e.board_cards[r][t.currentPlayer].push(e.player_hands[t.currentPlayer][n]);var a=e.unseen_cards.indexOf(e.player_hands[t.currentPlayer][n]);-1!==a&&e.unseen_cards.splice(a,1),e.player_hands[t.currentPlayer].splice(n,1)},claimFlag:{move:function(e,t,n){if(null!==e.flag_statuses[n])return u.y;var r=function(e,t,n){for(var r=[],a=[],l=0;2!==l;l++)for(var s=0;s!==n[e][l].length;s++)l===parseInt(t)?r.push(n[e][l][s]):a.push(n[e][l][s]);return[r,a]}(n,t.currentPlayer,e.board_cards);if(!function(e,t,n){for(var r=new Set(c),a=0;9!==a;a++)for(var l=0;2!==l;l++)for(var s=0;s!==C[a][l].length;s++)r.delete(C[a][l][s]);var o=function(e){var t=P(e);if(3!==e.length)return["incomplete",t];var n=T(e),r=O(e),a=D(e);return n&&r?["straightflush",t]:a?["set",t]:n?["flush",t]:r?["straight",t]:["sum",t]}(e),i=function(e,t){var n=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=n.length);if(!T(t)||!O(t))return-1;if(3===t.length)return P(t);for(var a=r-1;a>=0;a--){var l=t.slice(),s=n.slice();l.push(n[a]),s.splice(a,1);var o=e(l,s,a);if(-1!==o)return o}return-1}(e,t);if(-1!==n)return["straightflush",n];if(-1!==(n=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=n.length);if(!D(t))return-1;if(3===t.length)return P(t);for(var a=r-1;a>=0;a--){var l=t.slice(),s=n.slice();l.push(n[a]),s.splice(a,1);var o=e(l,s,a);if(-1!==o)return o}return-1}(e,t)))return["set",n];if(-1!==(n=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=n.length);if(!T(t))return-1;if(3===t.length)return P(t);for(var a=r-1;a>=0;a--){var l=t.slice(),s=n.slice();l.push(n[a]),s.splice(a,1);var o=e(l,s,a);if(-1!==o)return o}return-1}(e,t)))return["flush",n];if(-1!==(n=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=n.length);if(!O(t))return-1;if(3===t.length)return P(t);for(var a=r-1;a>=0;a--){var l=t.slice(),s=n.slice();l.push(n[a]),s.splice(a,1);var o=e(l,s,a);if(-1!==o)return o}return-1}(e,t)))return["straight",n];if(-1!==(n=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=n.length);if(3===t.length)return P(t);for(var a=r-1;a>=0;a--){var l=t.slice(),s=n.slice();l.push(n[a]),s.splice(a,1);var o=e(l,s,a);if(-1!==o)return o}return-1}(e,t)))return["sum",n];return["incomplete",n]}(t,n);return u=o,p=i,d.get(u[0])>d.get(p[0])||!(d.get(u[0])<d.get(p[0]))&&u[1]>=p[1];var u,p}(r[0],r[1],e.unseen_cards))return u.y;e.flag_statuses[n]=t.currentPlayer},noLimit:!0},drawCard:{move:function(e,t,n){return 0===t.numMoves||0===e.troop_deck.length?u.y:(e.player_hands[t.currentPlayer].push(e.troop_deck.pop()),void t.events.endTurn())},client:!1},passTurn:function(e,t){if(!j(e,t))return u.y;t.events.endTurn()}},playerView:function(e,t,n){return function(e,t){for(var n=new Array(e.troop_deck.length).fill("troop"),r=new Array(e.tactics_deck.length).fill("tactics"),a=[],l=0;2!==l;l++)if(parseInt(t)===l)a.push(e.player_hands[l]);else{for(var s=[],o=0;o!==e.player_hands[l].length;o++)s.push("troop");a.push(s)}return{troop_deck:n,tactics_deck:r,player_hands:a,board_cards:e.board_cards,unseen_cards:e.unseen_cards,flag_statuses:e.flag_statuses}}(e,n)},endIf:function(e,t){if(function(e,t){for(var n=0,r=0,a=0;9!==a;a++)if(e[a]===t?(n++,r++):r=0,n>=5||r>=3)return!0;return!1}(e.flag_statuses,t.currentPlayer))return{winner:t.currentPlayer}}};function P(e){for(var t=0,n=0;n!==e.length;n++)t+=f.get(e[n][0]);return t}function T(e){for(var t=null,n=0;n!==e.length;n++)if(null===t)t=e[n][1];else if(t!==e[n][1])return!1;return!0}function O(e){for(var t=0;t!==e.length;t++)for(var n=t+1;n!==e.length;n++){var r=Math.abs(f.get(e[t][0])-f.get(e[n][0]));if(0===r||r>=3)return!1}return!0}function D(e){for(var t=null,n=0;n!==e.length;n++)if(null===t)t=e[n][0];else if(t!==e[n][0])return!1;return!0}function F(e){for(var t=e.length-1;t>=0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[n];e[n]=e[t],e[t]=r}}function j(e,t){return 0===t.numMoves?!function(e,t,n,r){for(var a=!1,l=0;l!==r.length&&!a;l++)2===r[l].length&&(a=!0);if(!a)return!1;for(var s=0;9!==s;s++)if(3!==e[s][t].length&&null===n[s])return!0;return!1}(e.board_cards,t.currentPlayer,e.flag_statuses,e.player_hands[t.currentPlayer]):0===e.troop_deck.length}var I=j,G=n(4),S=n(5),A=n(9),M=n(8),L=new Map([["r","#FF0000"],["o","#FFA500"],["y","#FFFF00"],["g","#008000"],["b","#0000FF"],["p","#800080"]]),N=function(e){Object(A.a)(n,e);var t=Object(M.a)(n);function n(e){var r;return Object(G.a)(this,n),(r=t.call(this,e)).cardRefs=a.a.createRef(),r}return Object(S.a)(n,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.cardRefs.current.getContext("2d");e.clearRect(0,0,80,150);var t="top"===this.props.side&&this.props.selected||"bottom"===this.props.side&&!this.props.selected?0:30;e.translate(0,t),2===this.props.str.length?U(e,this.props.str):"troop"===this.props.str&&function(e){V(e,80,120,7,"#000000"),e.fillStyle="#D2B48C",e.fillRect(7,7,66,106),e.font="16px Verdana",e.fillStyle="#000000",e.textAlign="center",e.fillText("TROOP",40,60)}(e),e.translate(0,-t)}},{key:"render",value:function(){return a.a.createElement("canvas",{ref:this.cardRefs,width:80,height:150})}}]),n}(a.a.Component),J=function(e){Object(A.a)(n,e);var t=Object(M.a)(n);function n(e){var r;return Object(G.a)(this,n),(r=t.call(this,e)).formationRefs=a.a.createRef(),r}return Object(S.a)(n,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.formationRefs.current.getContext("2d");if(e.clearRect(0,0,80,190),"top"===this.props.side){e.translate(0,70);for(var t=0;t!==this.props.cards.length;t++)U(e,this.props.cards[t]),e.translate(0,-35);e.translate(0,-35*(2-this.props.cards.length))}else{for(var n=0;n!==this.props.cards.length;n++)U(e,this.props.cards[n]),e.translate(0,35);e.translate(0,-35*this.props.cards.length)}this.props.show_flag&&W(e,"top"===this.props.side?35:105)}},{key:"render",value:function(){return a.a.createElement("canvas",{ref:this.formationRefs,width:80,height:190})}}]),n}(a.a.Component),B=function(e){Object(A.a)(n,e);var t=Object(M.a)(n);function n(e){var r;return Object(G.a)(this,n),(r=t.call(this,e)).flagRefs=a.a.createRef(),r}return Object(S.a)(n,[{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.flagRefs.current.getContext("2d");e.clearRect(0,0,80,50),this.props.show_flag&&W(e,0)}},{key:"render",value:function(){return a.a.createElement("canvas",{ref:this.flagRefs,width:80,height:50})}}]),n}(a.a.Component);function U(e,t){var n=t[0],r=t[1];V(e,80,120,7,"#FFFFFF"),e.fillStyle=L.get(r),e.fillRect(7,7,66,106),e.fillStyle="#FFFFFF",e.fillRect(7,7,20,25),e.fillRect(53,88,20,25),e.font="18px Verdana",e.fillStyle="#000000",e.textAlign="center";for(var a=e.measureText("M").width,l=0;2!==l;l++){if("T"!==n)e.fillText(n,17,19.5+a/2-2);else{var s=e.measureText("1").width,o=e.measureText("0").width;e.fillText("1",17-s/2+2,19.5+a/2-2),e.fillText("0",17+o/2-2,19.5+a/2-2)}if("6"===n||"9"===n){var i=e.measureText(n).width;e.lineWidth=1,e.beginPath(),e.moveTo(17-i/2,19.5+a/2+1),e.lineTo(17+i/2,19.5+a/2+1),e.stroke()}e.rotate(Math.PI),e.translate(-80,-120)}}function V(e,t,n,r,a){e.strokeStyle="#000000",e.fillStyle=a;e.lineWidth=2,e.beginPath(),e.moveTo(r+1,1),e.lineTo(t-r-1,1),e.arcTo(t-1,1,t-1,r+1,r+1),e.lineTo(t-1,n-r-1),e.arcTo(t-1,n-1,t-r-1,n-1,r+1),e.lineTo(r+1,n-1),e.arcTo(1,n-1,1,r+1,r+1),e.lineTo(1,r+1),e.arcTo(1,1,r+1,1,r+1),e.closePath(),e.fill(),e.stroke()}function W(e,t){var n=document.getElementById("flag");e.drawImage(n,15,t,50,50)}var z=function(e){Object(A.a)(n,e);var t=Object(M.a)(n);function n(e){var r;return Object(G.a)(this,n),(r=t.call(this,e)).selected_card=null,r}return Object(S.a)(n,[{key:"onClickCard",value:function(e,t){this.props.ctx.currentPlayer===e&&this.selected_card!==t&&(this.selected_card=t,this.forceUpdate())}},{key:"onClickSlot",value:function(e,t){this.props.ctx.currentPlayer===e&&null!==this.selected_card&&(this.props.moves.playCard(this.selected_card,t),this.selected_card=null)}},{key:"onClickFlag",value:function(e){this.props.moves.claimFlag(e)}},{key:"onClickDeck",value:function(e){this.props.moves.drawCard(e)}},{key:"onClickPass",value:function(){this.props.moves.passTurn()}},{key:"render",value:function(){var e=this,t=[],n=[];n.push(a.a.createElement("td",{key:n.length,style:{textAlign:"center"}},"0"===this.props.ctx.currentPlayer?"Your turn!":""));for(var r=function(t){n.push(a.a.createElement("td",{key:n.length,onClick:function(){return e.onClickCard("0",t)}},a.a.createElement(N,{str:e.props.G.player_hands[0][t],side:"top",selected:t===e.selected_card&&"0"===e.props.ctx.currentPlayer&&"0"===e.props.playerID&&0===e.props.ctx.numMoves})))},l=0;l<this.props.G.player_hands[0].length;l++)r(l);t.push(a.a.createElement("tr",{key:t.length},n)),n=[];for(var s=new Array(2).fill("none"),o=0;2!==o;o++)this.props.ctx.currentPlayer===this.props.playerID&&this.props.ctx.currentPlayer===o.toString()&&I(this.props.G,this.props.ctx)&&(s[o]="block");n.push(a.a.createElement("td",{rowSpan:"3",key:n.length},a.a.createElement("table",{id:"troop_deck",style:{margin:"auto"}},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",{style:{height:"50px"}},a.a.createElement("input",{type:"button",value:"Pass",style:{margin:"auto",display:s[0]},onClick:function(){return e.onClickPass()}}))),a.a.createElement("tr",null,a.a.createElement("td",{onClick:function(){return e.onClickDeck(0)}},a.a.createElement(N,{str:this.props.G.troop_deck.length>0?this.props.G.troop_deck[0]:""}))),a.a.createElement("tr",null,a.a.createElement("td",{style:{height:"50px"}},a.a.createElement("input",{type:"button",value:"Pass",style:{margin:"auto",display:s[1]},onClick:function(){return e.onClickPass()}})))))));for(var i=function(t){n.push(a.a.createElement("td",{key:n.length,onClick:function(){return e.onClickSlot("0",t)}},a.a.createElement(J,{cards:e.props.G.board_cards[t][0],side:"top",show_flag:"0"===e.props.G.flag_statuses[t]})))},u=0;u<9;u++)i(u);t.push(a.a.createElement("tr",{key:t.length},n)),n=[];for(var c=function(t){n.push(a.a.createElement("td",{key:n.length,onClick:function(){return e.onClickFlag(t)}},a.a.createElement(B,{show_flag:null===e.props.G.flag_statuses[t]})))},p=0;p<9;p++)c(p);t.push(a.a.createElement("tr",{key:t.length},n)),n=[];for(var h=function(t){n.push(a.a.createElement("td",{key:n.length,onClick:function(){return e.onClickSlot("1",t)}},a.a.createElement(J,{cards:e.props.G.board_cards[t][1],side:"bottom",show_flag:"1"===e.props.G.flag_statuses[t]})))},f=0;f<9;f++)h(f);t.push(a.a.createElement("tr",{key:t.length},n)),(n=[]).push(a.a.createElement("td",{key:n.length,style:{textAlign:"center"}},"1"===this.props.ctx.currentPlayer?"Your turn!":""));for(var d=function(t){n.push(a.a.createElement("td",{key:n.length,onClick:function(){return e.onClickCard("1",t)}},a.a.createElement(N,{str:e.props.G.player_hands[1][t],side:"bottom",selected:t===e.selected_card&&"1"===e.props.ctx.currentPlayer&&"1"===e.props.playerID&&0===e.props.ctx.numMoves})))},m=0;m<this.props.G.player_hands[1].length;m++)d(m);return t.push(a.a.createElement("tr",{key:t.length},n)),a.a.createElement("div",null,a.a.createElement("table",{id:"board",style:{margin:"auto"}},a.a.createElement("tbody",null,t)))}}]),n}(a.a.Component),Y=function(e){Object(A.a)(n,e);var t=Object(M.a)(n);function n(){return Object(G.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"handleChangeName",value:function(e){this.setState({playerName:e.target.value})}},{key:"handleNewRoom",value:function(e){this._createRoom("battle-line",2)}},{key:"handleRefreshRooms",value:function(e){this._updateConnection()}},{key:"handleJoinRoom",value:function(e,t,n){this._joinRoom("battle-line",t,n)}},{key:"handleLeaveRoom",value:function(e,t){this._leaveRoom("battle-line",t)}},{key:"handleEnterLobby",value:function(e){this._enterLobby(this.state.playerName)}},{key:"handleExitLobby",value:function(e){this._exitLobby()}},{key:"handleStartGame",value:function(e,t,n){this._startGame("battle-line",{numPlayers:2,gameID:t,playerID:n})}},{key:"handleExitRoom",value:function(e){this._exitRoom()}},{key:"render",value:function(){var e=this,t=[],n=[],r={width:"150px",textAlign:"center",padding:"3px"},l={width:"150px",textAlign:"center",padding:"3px"},s={width:"30px",textAlign:"center",padding:"3px"},o={width:"100px",textAlign:"center",padding:"3px"};n.push(a.a.createElement("th",{style:r},"Room ID")),n.push(a.a.createElement("th",{style:l},"Player 1")),n.push(a.a.createElement("th",{style:s},"vs.")),n.push(a.a.createElement("th",{style:l},"Player 2")),n.push(a.a.createElement("th",{style:o},a.a.createElement("input",{type:"button",value:"New Room",onClick:function(t){return e.handleNewRoom(t)}}))),n.push(a.a.createElement("th",{style:o},a.a.createElement("input",{type:"button",value:"Refresh",onClick:function(t){return e.handleRefreshRooms(t)}}))),t.push(a.a.createElement("tr",null,n));for(var i=[],u=function(){p=[];var t=e.connection.rooms[c];if(h=t.players.length>0?t.players[0].name:void 0,f=t.players.length>1?t.players[1].name:void 0,p.push(a.a.createElement("td",{style:r},t.gameID)),void 0!==h?p.push(a.a.createElement("td",{style:l},h)):p.push(a.a.createElement("td",{style:l},a.a.createElement("input",{type:"button",value:"Join",onClick:function(n){return e.handleJoinRoom(n,t.gameID,0)}}))),p.push(a.a.createElement("td",{style:s},"vs.")),void 0!==f?p.push(a.a.createElement("td",{style:l},f)):p.push(a.a.createElement("td",{style:l},a.a.createElement("input",{type:"button",value:"Join",onClick:function(n){return e.handleJoinRoom(n,t.gameID,1)}}))),h===e.state.playerName||f===e.state.playerName?p.push(a.a.createElement("td",{style:o},a.a.createElement("input",{type:"button",value:"Leave",onClick:function(n){return e.handleLeaveRoom(n,t.gameID)}}))):p.push(a.a.createElement("td",{style:o})),h===e.state.playerName&&void 0!==f||f===e.state.playerName&&void 0!==h){var n=e.state.playerName===h?"0":"1";p.push(a.a.createElement("td",{style:o},a.a.createElement("input",{type:"button",value:"Play",onClick:function(r){return e.handleStartGame(r,t.gameID,n)}})))}else p.push(a.a.createElement("td",{style:o}));i.push(a.a.createElement("tr",null,p))},c=0;c!==this.connection.rooms.length;c++){var p,h,f;u()}if("enter"===this.state.phase)return a.a.createElement("div",null,"Enter name: ",a.a.createElement("input",{type:"text",value:this.state.playerName,onChange:function(t){return e.handleChangeName(t)}}),a.a.createElement("input",{type:"button",value:"Enter Lobby",onClick:function(t){return e.handleEnterLobby(t)}}));if("list"===this.state.phase)return a.a.createElement("div",null,a.a.createElement("input",{type:"button",value:"Exit Lobby",onClick:function(t){return e.handleExitLobby(t)}}),a.a.createElement("br",null),a.a.createElement("table",{id:"rooms"},a.a.createElement("thead",null,t),a.a.createElement("tbody",null,i)));if("play"===this.state.phase){var d=a.a.createElement(this.state.runningGame.app,{gameID:this.state.runningGame.gameID,playerID:this.state.runningGame.playerID,credentials:this.state.runningGame.credentials});return a.a.createElement("div",null,d,a.a.createElement("br",null),a.a.createElement("input",{type:"button",value:"Exit Game",onClick:function(t){return e.handleExitRoom(t)}}))}}}]),n}(o.b),X=function(e){Object(A.a)(n,e);var t=Object(M.a)(n);function n(){return Object(G.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("table",{style:{width:"100%"},bgcolor:"#E4DB86"},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",{style:{fontFamily:"Verdana",fontSize:"30px",padding:"10px"}},"BATTLE LINE"),a.a.createElement("td",{style:{textAlign:"right"}},a.a.createElement("a",{href:"https://github.com/rsandzimier/battleline"},a.a.createElement("img",{id:"github",src:"https://raw.githubusercontent.com/rsandzimier/battleline/master/github_logo.png",style:{height:"50px"},alt:"Github logo"})))))),a.a.createElement("br",null))}}]),n}(a.a.Component),$=(Object(o.a)({game:R,board:z,multiplayer:Object(i.b)({server:"https://battleline-backend.herokuapp.com"})}),function(){return a.a.createElement("div",null,a.a.createElement(X,null),a.a.createElement(Y,{gameServer:"https://battleline-backend.herokuapp.com",lobbyServer:"https://battleline-backend.herokuapp.com",gameComponents:[{game:R,board:z}]}))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.9bdcbf92.chunk.js.map